coord_sf(xlim = c(-30, 60), ylim = c(-40, 45), expand = FALSE)+
theme(panel.grid.major = element_blank(),
panel.border = element_blank(),
title =element_text(size=14),
axis.ticks.y = element_blank(),
axis.text.y = element_blank(),
axis.ticks.x = element_blank(),
axis.text.x = element_blank(),
legend.background = element_rect(fill = "white"),
#legend.title=element_blank(),
legend.key = element_rect( fill = "white"),
legend.position = c(0.2, 0.3),
legend.key.size = unit(0.6, 'cm'),
legend.text=element_text(size=14))+
scale_fill_gradient(low = "yellow", high = "darkred",
breaks = c(-10,- 5, 0, 5, 10),
limits = c(-10, 10),
name = "Polity Score") + # Specify breaks for the color scale
scale_color_manual(name = "", values = c("Coup Happened" = "darkgreen"))
spatial_join  %>%
filter(year==1980) %>%
ggplot(aes()) + geom_sf(data =  spatial_join, aes(fill = polity2))  +
geom_sf(data = coup_points, aes(color = "Coup Happened"), fill="green", size = 3, shape = 21) + # Add green points for coup1 == 1
labs(subtitle ="") +geom_sf(data = world, fill = "transparent") + theme_bw() +
coord_sf(xlim = c(-30, 60), ylim = c(-40, 45), expand = FALSE)+
theme(panel.grid.major = element_blank(),
panel.border = element_blank(),
title =element_text(size=14),
axis.ticks.y = element_blank(),
axis.text.y = element_blank(),
axis.ticks.x = element_blank(),
axis.text.x = element_blank(),
legend.background = element_rect(fill = "white"),
#legend.title=element_blank(),
legend.key = element_rect( fill = "white"),
legend.position = c(0.2, 0.3),
legend.key.size = unit(0.6, 'cm'),
legend.text=element_text(size=14),
legend.title = element_text(margin = margin(b = 10))  # Adjust the bottom margin
)+
scale_fill_gradient(low = "yellow", high = "darkred",
breaks = c(-10,- 5, 0, 5, 10),
limits = c(-10, 10),
name = "Polity Score") + # Specify breaks for the color scale
scale_color_manual(name = "", values = c("Coup Happened" = "darkgreen"))
ggsave(paste0("figures/couppolity_",1980,".png"), width = 12, height = 12, dpi = 900)
ggsave(paste0("figures/couppolity_",1980,".png"), width = 10, height = 10, dpi = 900)
for (i in 1965:2005) {
# Filter for coup1 == spatial_join
coup_points <- spatial_join %>%
filter(coup1 == 1, year==i) %>%
st_centroid()  # Ensure we get the centroids
spatial_join  %>%
filter(year==i) %>%
ggplot(aes()) + geom_sf(data =  spatial_join, aes(fill = polity2))  +
geom_sf(data = coup_points, aes(color = "Coup Happened"), fill="green", size = 3, shape = 21) + # Add green points for coup1 == 1
labs(subtitle ="") +geom_sf(data = world, fill = "transparent") + theme_bw() +
coord_sf(xlim = c(-30, 60), ylim = c(-40, 45), expand = FALSE)+
theme(panel.grid.major = element_blank(),
panel.border = element_blank(),
title =element_text(size=14),
axis.ticks.y = element_blank(),
axis.text.y = element_blank(),
axis.ticks.x = element_blank(),
axis.text.x = element_blank(),
legend.background = element_rect(fill = "white"),
#legend.title=element_blank(),
legend.key = element_rect( fill = "white"),
legend.position = c(0.2, 0.3),
legend.key.size = unit(0.6, 'cm'),
legend.text=element_text(size=14),
legend.title = element_text(margin = margin(b = 10))  # Adjust the bottom margin
)+
scale_fill_gradient(low = "yellow", high = "darkred",
breaks = c(-10,- 5, 0, 5, 10),
limits = c(-10, 10),
name = "Polity Score") + # Specify breaks for the color scale
scale_color_manual(name = "", values = c("Coup Happened" = "darkgreen"))
ggsave(paste0("figures/couppolity_",i,".png"), width = 10, height = 10, dpi = 900)
}
View(spatial_join)
View(spatial_join)
View(spatial_join)
View(spatial_join)
spatial_join  %>%
filter(year==1971) %>%
ggplot(aes()) + geom_sf(data =  spatial_join, aes(fill = polity2))  +
geom_sf(data = coup_points, aes(color = "Coup Happened"), fill="green", size = 3, shape = 21) + # Add green points for coup1 == 1
labs(subtitle ="") +geom_sf(data = world, fill = "transparent") + theme_bw() +
coord_sf(xlim = c(-30, 60), ylim = c(-40, 45), expand = FALSE)+
theme(panel.grid.major = element_blank(),
panel.border = element_blank(),
title =element_text(size=14),
axis.ticks.y = element_blank(),
axis.text.y = element_blank(),
axis.ticks.x = element_blank(),
axis.text.x = element_blank(),
legend.background = element_rect(fill = "white"),
#legend.title=element_blank(),
legend.key = element_rect( fill = "white"),
legend.position = c(0.2, 0.3),
legend.key.size = unit(0.6, 'cm'),
legend.text=element_text(size=14),
legend.title = element_text(margin = margin(b = 10))  # Adjust the bottom margin
)+
scale_fill_gradient(low = "yellow", high = "darkred",
breaks = c(-10,- 5, 0, 5, 10),
limits = c(-10, 10),
name = "Polity Score") + # Specify breaks for the color scale
scale_color_manual(name = "", values = c("Coup Happened" = "darkgreen"))
# Filter for coup1 == spatial_join
coup_points <- spatial_join %>%
filter(coup1 == 1, year==1971) %>%
st_centroid()  # Ensure we get the centroids
spatial_join  %>%
filter(year==1971) %>%
ggplot(aes()) + geom_sf(data =  spatial_join, aes(fill = polity2))  +
geom_sf(data = coup_points, aes(color = "Coup Happened"), fill="green", size = 3, shape = 21) + # Add green points for coup1 == 1
labs(subtitle ="") +geom_sf(data = world, fill = "transparent") + theme_bw() +
coord_sf(xlim = c(-30, 60), ylim = c(-40, 45), expand = FALSE)+
theme(panel.grid.major = element_blank(),
panel.border = element_blank(),
title =element_text(size=14),
axis.ticks.y = element_blank(),
axis.text.y = element_blank(),
axis.ticks.x = element_blank(),
axis.text.x = element_blank(),
legend.background = element_rect(fill = "white"),
#legend.title=element_blank(),
legend.key = element_rect( fill = "white"),
legend.position = c(0.2, 0.3),
legend.key.size = unit(0.6, 'cm'),
legend.text=element_text(size=14),
legend.title = element_text(margin = margin(b = 10))  # Adjust the bottom margin
)+
scale_fill_gradient(low = "yellow", high = "darkred",
breaks = c(-10,- 5, 0, 5, 10),
limits = c(-10, 10),
name = "Polity Score") + # Specify breaks for the color scale
scale_color_manual(name = "", values = c("Coup Happened" = "darkgreen"))
View(spatial_join)
spatial_join  %>%
filter(year==1971) %>%
ggplot(aes()) + geom_sf(data =  spatial_join, aes(fill = polity2))  +
geom_sf(data = coup_points, aes(color = "Coup Happened"), fill="green", size = 3, shape = 21) + # Add green points for coup1 == 1
labs(subtitle ="") +geom_sf(data = world, fill = "transparent") + theme_bw() +
coord_sf(xlim = c(-30, 60), ylim = c(-40, 45), expand = FALSE)+
theme(panel.grid.major = element_blank(),
panel.border = element_blank(),
title =element_text(size=14),
axis.ticks.y = element_blank(),
axis.text.y = element_blank(),
axis.ticks.x = element_blank(),
axis.text.x = element_blank(),
legend.background = element_rect(fill = "white"),
#legend.title=element_blank(),
legend.key = element_rect( fill = "white"),
legend.position = c(0.2, 0.3),
legend.key.size = unit(0.6, 'cm'),
legend.text=element_text(size=14),
legend.title = element_text(margin = margin(b = 10))  # Adjust the bottom margin
)+
scale_fill_continuous(low = "yellow", high = "darkred",
breaks = c(-10,- 5, 0, 5, 10),
limits = c(-10, 10),
name = "Polity Score") + # Specify breaks for the color scale
scale_color_manual(name = "", values = c("Coup Happened" = "darkgreen"))
spatial_join  %>%
filter(year==1971) %>%
ggplot(aes()) + geom_sf(data =  spatial_join, aes(fill = polity2))  +
geom_sf(data = coup_points, aes(color = "Coup Happened"), fill="green", size = 3, shape = 21) + # Add green points for coup1 == 1
labs(subtitle ="") +geom_sf(data = world, fill = "transparent") + theme_bw() +
coord_sf(xlim = c(-30, 60), ylim = c(-40, 45), expand = FALSE)+
theme(panel.grid.major = element_blank(),
panel.border = element_blank(),
title =element_text(size=14),
axis.ticks.y = element_blank(),
axis.text.y = element_blank(),
axis.ticks.x = element_blank(),
axis.text.x = element_blank(),
legend.background = element_rect(fill = "white"),
#legend.title=element_blank(),
legend.key = element_rect( fill = "white"),
legend.position = c(0.2, 0.3),
legend.key.size = unit(0.6, 'cm'),
legend.text=element_text(size=14),
legend.title = element_text(margin = margin(b = 10))  # Adjust the bottom margin
)+
scale_fill_continuous(low = "darkred", high = "yellow",
breaks = c(-10,- 5, 0, 5, 10),
limits = c(-10, 10),
name = "Polity Score") + # Specify breaks for the color scale
scale_color_manual(name = "", values = c("Coup Happened" = "darkgreen"))
spatial_join  %>%
filter(year==1971) %>%
ggplot(aes()) + geom_sf(data =  spatial_join, aes(fill = polity2))  +
geom_sf(data = coup_points, aes(color = "Coup Happened"), fill="green", size = 3, shape = 21) + # Add green points for coup1 == 1
labs(subtitle ="") +geom_sf(data = world, fill = "transparent") + theme_bw() +
coord_sf(xlim = c(-30, 60), ylim = c(-40, 45), expand = FALSE)+
theme(panel.grid.major = element_blank(),
panel.border = element_blank(),
title =element_text(size=14),
axis.ticks.y = element_blank(),
axis.text.y = element_blank(),
axis.ticks.x = element_blank(),
axis.text.x = element_blank(),
legend.background = element_rect(fill = "white"),
#legend.title=element_blank(),
legend.key = element_rect( fill = "white"),
legend.position = c(0.2, 0.3),
legend.key.size = unit(0.6, 'cm'),
legend.text=element_text(size=14),
legend.title = element_text(margin = margin(b = 10))  # Adjust the bottom margin
)+
scale_fill_continuous(low = "darkred", high = "yellow",
breaks = c(-10,- 5, 0, 5, 10),
limits = c(-10, 10),
guide="colorbar",na.value="white",
name = "Polity Score") + # Specify breaks for the color scale
scale_color_manual(name = "", values = c("Coup Happened" = "darkgreen"))
spatial_join  %>%
filter(year==1971) %>%
ggplot(aes()) + geom_sf(data =  spatial_join, aes(fill = polity2),color = NA)  +
geom_sf(data = coup_points, aes(color = "Coup Happened"), fill="green", size = 3, shape = 21) + # Add green points for coup1 == 1
labs(subtitle ="") +geom_sf(data = world, fill = "transparent") + theme_bw() +
coord_sf(xlim = c(-30, 60), ylim = c(-40, 45), expand = FALSE)+
theme(panel.grid.major = element_blank(),
panel.border = element_blank(),
title =element_text(size=14),
axis.ticks.y = element_blank(),
axis.text.y = element_blank(),
axis.ticks.x = element_blank(),
axis.text.x = element_blank(),
legend.background = element_rect(fill = "white"),
#legend.title=element_blank(),
legend.key = element_rect( fill = "white"),
legend.position = c(0.2, 0.3),
legend.key.size = unit(0.6, 'cm'),
legend.text=element_text(size=14),
legend.title = element_text(margin = margin(b = 10))  # Adjust the bottom margin
)+
scale_fill_continuous(low = "darkred", high = "yellow",
breaks = c(-10,- 5, 0, 5, 10),
limits = c(-10, 10),
guide="colorbar", na.value="white",
name = "Polity Score") + # Specify breaks for the color scale
scale_color_manual(name = "", values = c("Coup Happened" = "darkgreen"))
spatial_join  %>%
filter(year==1971, country_name=="Benin")
View(spatial_join)
spatial_join  %>%
filter(year==1972, country_name=="Benin")
# Filter for coup1 == spatial_join
coup_points <- spatial_join %>%
filter(coup1 == 1, year==1972) %>%
st_centroid()  # Ensure we get the centroids
spatial_join  %>%
filter(year==1972) %>%
ggplot(aes()) + geom_sf(data =  spatial_join, aes(fill = polity2),color = NA)  +
geom_sf(data = coup_points, aes(color = "Coup Happened"), fill="green", size = 3, shape = 21) + # Add green points for coup1 == 1
labs(subtitle ="") +geom_sf(data = world, fill = "transparent") + theme_bw() +
coord_sf(xlim = c(-30, 60), ylim = c(-40, 45), expand = FALSE)+
theme(panel.grid.major = element_blank(),
panel.border = element_blank(),
title =element_text(size=14),
axis.ticks.y = element_blank(),
axis.text.y = element_blank(),
axis.ticks.x = element_blank(),
axis.text.x = element_blank(),
legend.background = element_rect(fill = "white"),
#legend.title=element_blank(),
legend.key = element_rect( fill = "white"),
legend.position = c(0.2, 0.3),
legend.key.size = unit(0.6, 'cm'),
legend.text=element_text(size=14),
legend.title = element_text(margin = margin(b = 10))  # Adjust the bottom margin
)+
scale_fill_continuous(low = "darkred", high = "yellow",
breaks = c(-10,- 5, 0, 5, 10),
limits = c(-10, 10),
guide="colorbar", na.value="white",
name = "Polity Score") + # Specify breaks for the color scale
scale_color_manual(name = "", values = c("Coup Happened" = "darkgreen"))
spatial_join  %>%
filter(year==1972, country_name=="Benin")
spatial_join  %>%
filter(year==1972, country_name=="Eritrea")
spatial_join  %>%
filter(year==1972, country_name=="Cameroon")
spatial_join  %>%
filter(year==1972) %>%
ggplot(aes()) + geom_sf(data =  spatial_join, aes(fill = polity2),color = NA)  +
geom_sf(data = coup_points, aes(color = "Coup Happened"), fill="green", size = 3, shape = 21) + # Add green points for coup1 == 1
labs(subtitle ="") +geom_sf(data = world, fill = "transparent") + theme_bw() +
coord_sf(xlim = c(-30, 60), ylim = c(-40, 45), expand = FALSE)+
theme(panel.grid.major = element_blank(),
panel.border = element_blank(),
title =element_text(size=14),
axis.ticks.y = element_blank(),
axis.text.y = element_blank(),
axis.ticks.x = element_blank(),
axis.text.x = element_blank(),
legend.background = element_rect(fill = "white"),
#legend.title=element_blank(),
legend.key = element_rect( fill = "white"),
legend.position = c(0.2, 0.3),
legend.key.size = unit(0.6, 'cm'),
legend.text=element_text(size=14),
legend.title = element_text(margin = margin(b = 10))  # Adjust the bottom margin
)+
scale_fill_continuous(low = "darkred", high = "powderblue",
breaks = c(-10,- 5, 0, 5, 10),
limits = c(-10, 10),
guide="colorbar", na.value="white",
name = "Polity Score") + # Specify breaks for the color scale
scale_color_manual(name = "", values = c("Coup Happened" = "darkgreen"))
spatial_join  %>%
filter(year==1972) %>%
ggplot(aes()) + geom_sf(data =  spatial_join, aes(fill = polity2),color = NA)  +
geom_sf(data = coup_points, aes(color = "Coup Happened"), fill="green", size = 3, shape = 21) + # Add green points for coup1 == 1
labs(subtitle ="") +geom_sf(data = world, fill = "transparent") + theme_bw() +
coord_sf(xlim = c(-30, 60), ylim = c(-40, 45), expand = FALSE)+
theme(panel.grid.major = element_blank(),
panel.border = element_blank(),
title =element_text(size=14),
axis.ticks.y = element_blank(),
axis.text.y = element_blank(),
axis.ticks.x = element_blank(),
axis.text.x = element_blank(),
legend.background = element_rect(fill = "white"),
#legend.title=element_blank(),
legend.key = element_rect( fill = "white"),
legend.position = c(0.2, 0.3),
legend.key.size = unit(0.6, 'cm'),
legend.text=element_text(size=14),
legend.title = element_text(margin = margin(b = 10))  # Adjust the bottom margin
)+
scale_fill_continuous(low = "powderblue", high = "darkred",
breaks = c(-10,- 5, 0, 5, 10),
limits = c(-10, 10),
guide="colorbar", na.value="white",
name = "Polity Score") + # Specify breaks for the color scale
scale_color_manual(name = "", values = c("Coup Happened" = "darkgreen"))
spatial_join  %>%
filter(year==1972) %>%
ggplot(aes()) + geom_sf(data =  spatial_join, aes(fill = polity2),color = NA)  +
geom_sf(data = coup_points, aes(color = "Coup Happened"), fill="green", size = 3, shape = 21) + # Add green points for coup1 == 1
labs(subtitle ="") +geom_sf(data = world, fill = "transparent") + theme_bw() +
coord_sf(xlim = c(-30, 60), ylim = c(-40, 45), expand = FALSE)+
theme(panel.grid.major = element_blank(),
panel.border = element_blank(),
title =element_text(size=14),
axis.ticks.y = element_blank(),
axis.text.y = element_blank(),
axis.ticks.x = element_blank(),
axis.text.x = element_blank(),
legend.background = element_rect(fill = "white"),
#legend.title=element_blank(),
legend.key = element_rect( fill = "white"),
legend.position = c(0.2, 0.3),
legend.key.size = unit(0.6, 'cm'),
legend.text=element_text(size=14),
legend.title = element_text(margin = margin(b = 10))  # Adjust the bottom margin
)+
scale_fill_continuous(low = "powderblue", high = "darkred",
breaks = c(-10,- 5, 0, 5, 10),
limits = c(0,max(spatial_join$polity2)),
guide="colorbar", na.value="white",
name = "Polity Score") + # Specify breaks for the color scale
scale_color_manual(name = "", values = c("Coup Happened" = "darkgreen"))
spatial_join  %>%
filter(year==1972) %>%
ggplot(aes()) + geom_sf(data =  spatial_join, aes(fill = polity2),color = NA)  +
geom_sf(data = coup_points, aes(color = "Coup Happened"), fill="green", size = 3, shape = 21) + # Add green points for coup1 == 1
labs(subtitle ="") +geom_sf(data = world, fill = "transparent") + theme_bw() +
coord_sf(xlim = c(-30, 60), ylim = c(-40, 45), expand = FALSE)+
theme(panel.grid.major = element_blank(),
panel.border = element_blank(),
title =element_text(size=14),
axis.ticks.y = element_blank(),
axis.text.y = element_blank(),
axis.ticks.x = element_blank(),
axis.text.x = element_blank(),
legend.background = element_rect(fill = "white"),
#legend.title=element_blank(),
legend.key = element_rect( fill = "white"),
legend.position = c(0.2, 0.3),
legend.key.size = unit(0.6, 'cm'),
legend.text=element_text(size=14),
legend.title = element_text(margin = margin(b = 10))  # Adjust the bottom margin
)+
scale_fill_continuous(low = "powderblue", high = "darkred",
breaks = c(-10,- 5, 0, 5, 10),
limits = c(-10,max(spatial_join$polity2)),
guide="colorbar", na.value="white",
name = "Polity Score") + # Specify breaks for the color scale
scale_color_manual(name = "", values = c("Coup Happened" = "darkgreen"))
spatial_join  %>%
filter(year==1972) %>%
ggplot(aes()) + geom_sf(data =  spatial_join, aes(fill = polity2),color = NA)  +
geom_sf(data = coup_points, aes(color = "Coup Happened"), fill="green", size = 3, shape = 21) + # Add green points for coup1 == 1
labs(subtitle ="") +geom_sf(data = world, fill = "transparent") + theme_bw() +
coord_sf(xlim = c(-30, 60), ylim = c(-40, 45), expand = FALSE)+
theme(panel.grid.major = element_blank(),
panel.border = element_blank(),
title =element_text(size=14),
axis.ticks.y = element_blank(),
axis.text.y = element_blank(),
axis.ticks.x = element_blank(),
axis.text.x = element_blank(),
legend.background = element_rect(fill = "white"),
#legend.title=element_blank(),
legend.key = element_rect( fill = "white"),
legend.position = c(0.2, 0.3),
legend.key.size = unit(0.6, 'cm'),
legend.text=element_text(size=14),
legend.title = element_text(margin = margin(b = 10))  # Adjust the bottom margin
)+
scale_fill_continuous(low = "powderblue", high = "darkred",
limits = c(-10,max(spatial_join$polity2)),
guide="colorbar", na.value="white",
name = "Polity Score") + # Specify breaks for the color scale
scale_color_manual(name = "", values = c("Coup Happened" = "darkgreen"))
spatial_join  %>%
filter(year==1972) %>%
ggplot(aes()) + geom_sf(data =  spatial_join, aes(fill = polity2),color = NA)  +
geom_sf(data = coup_points, aes(color = "Coup Happened"), fill="green", size = 3, shape = 21) + # Add green points for coup1 == 1
labs(subtitle ="") +geom_sf(data = world, fill = "transparent") + theme_bw() +
coord_sf(xlim = c(-30, 60), ylim = c(-40, 45), expand = FALSE)+
theme(panel.grid.major = element_blank(),
panel.border = element_blank(),
title =element_text(size=14),
axis.ticks.y = element_blank(),
axis.text.y = element_blank(),
axis.ticks.x = element_blank(),
axis.text.x = element_blank(),
legend.background = element_rect(fill = "white"),
#legend.title=element_blank(),
legend.key = element_rect( fill = "white"),
legend.position = c(0.2, 0.3),
legend.key.size = unit(0.6, 'cm'),
legend.text=element_text(size=14),
legend.title = element_text(margin = margin(b = 10))  # Adjust the bottom margin
)+
scale_fill_continuous(low = "powderblue", high = "darkred",
guide="colorbar", na.value="white",
name = "Polity Score") + # Specify breaks for the color scale
scale_color_manual(name = "", values = c("Coup Happened" = "darkgreen"))
proof <- spatial_join  %>%
filter(year==1972)
View(proof)
ggplot(proof, aes(x=polity2))+geom_histogram()
proof  %>%
ggplot(aes()) + geom_sf(data =  proof, aes(fill = polity2),color = NA)  +
geom_sf(data = coup_points, aes(color = "Coup Happened"), fill="green", size = 3, shape = 21) + # Add green points for coup1 == 1
labs(subtitle ="") +geom_sf(data = world, fill = "transparent") + theme_bw() +
coord_sf(xlim = c(-30, 60), ylim = c(-40, 45), expand = FALSE)+
theme(panel.grid.major = element_blank(),
panel.border = element_blank(),
title =element_text(size=14),
axis.ticks.y = element_blank(),
axis.text.y = element_blank(),
axis.ticks.x = element_blank(),
axis.text.x = element_blank(),
legend.background = element_rect(fill = "white"),
#legend.title=element_blank(),
legend.key = element_rect( fill = "white"),
legend.position = c(0.2, 0.3),
legend.key.size = unit(0.6, 'cm'),
legend.text=element_text(size=14),
legend.title = element_text(margin = margin(b = 10))  # Adjust the bottom margin
)+
scale_fill_gradient(low = "yellow", high = "darkred",
breaks = c(-10,- 5, 0, 5, 10),
limits = c(-10, 10),
name = "Polity Score") + # Specify breaks for the color scale
scale_color_manual(name = "", values = c("Coup Happened" = "darkgreen"))
View(proof)
for (i in 1965:2005) {
# Filter for coup1 == spatial_join
coup_points <- spatial_join %>%
filter(coup1 == 1, year==i) %>%
st_centroid()  # Ensure we get the centroids
proof <- spatial_join  %>%
filter(year==i)
proof  %>%
ggplot(aes()) + geom_sf(data =  proof, aes(fill = polity2))  +
geom_sf(data = coup_points, aes(color = "Coup Happened"), fill="green", size = 3, shape = 21) + # Add green points for coup1 == 1
labs(subtitle ="") +geom_sf(data = world, fill = "transparent") + theme_bw() +
coord_sf(xlim = c(-30, 60), ylim = c(-40, 45), expand = FALSE)+
theme(panel.grid.major = element_blank(),
panel.border = element_blank(),
title =element_text(size=14),
axis.ticks.y = element_blank(),
axis.text.y = element_blank(),
axis.ticks.x = element_blank(),
axis.text.x = element_blank(),
legend.background = element_rect(fill = "white"),
#legend.title=element_blank(),
legend.key = element_rect( fill = "white"),
legend.position = c(0.2, 0.3),
legend.key.size = unit(0.6, 'cm'),
legend.text=element_text(size=14),
legend.title = element_text(margin = margin(b = 10))  # Adjust the bottom margin
)+
scale_fill_gradient(low = "darkred", high = "yellow",
breaks = c(-10,- 5, 0, 5, 10),
limits = c(-10, 10),
name = "Polity Score") + # Specify breaks for the color scale
scale_color_manual(name = "", values = c("Coup Happened" = "darkgreen"))
ggsave(paste0("figures/couppolity_",i,".png"), width = 10, height = 10, dpi = 900)
}
